function ajax_pieces(e,o,a){$.ajax(e,{success:function(e){var t=$(e).find(".piece-text-container").find("h2").html(),n=$(".template1"),i=n.clone();i.removeClass("template1"),i.removeClass("invisible"),i.find(".collapse").removeClass("in"),i.find(".accordion-toggle").attr("href","#"+ ++hash).text(o+" "+a),i.find(".panel-collapse").attr("id",hash).addClass("collapse").removeClass("in"),i.find(".panel-body").html(t),$("#accordion1").prepend(i.fadeIn())}})}function createPieceItem(e,o,a){var t=localStorage.getItem(e),n=$(".template1"),i=n.clone();i.removeClass("template1"),i.removeClass("invisible"),i.find(".collapse").removeClass("in"),i.find(".accordion-toggle").attr("href","#"+ ++hash).html(o),i.find(".panel-collapse").attr("id",hash).addClass("collapse").removeClass("in"),i.find(".panel-body").html(t),$("#accordion1").prepend(i.fadeIn())}function createComixItem(e,o){var a="<img src = 'http://harvardlampoon.com"+e+"'/>",t=$(".template4"),n=t.clone();n.removeClass("template4"),n.removeClass("invisible"),n.find(".collapse").removeClass("in"),n.find(".accordion-toggle").attr("href","#"+ ++hash).text(o),n.find(".panel-collapse").attr("id",hash).addClass("collapse").removeClass("in"),n.find(".panel-body").html(a),$("#accordion4").prepend(n.fadeIn())}function createIssueItem(e,o,a,t){for(piece in t){console.log(t[piece]);var n="http://harvardlampoon.com"+t[piece];chrome.storage.sync.get(n,function i(e){for(item in e){var o=e[item],t=o.Title,n=o.Url,i=o.Author,c=localStorage.getItem(n);console.log(c);var l=$(".template2"),s=l.clone();s.removeClass("template2"),s.removeClass("invisible"),s.find(".collapse").removeClass("in"),s.find(".accordion-toggle").attr("href","#"+ ++hash).html("<i>"+a+"</i>: "+t),s.find(".panel-collapse").attr("id",hash).addClass("collapse").removeClass("in"),s.find(".panel-body").html(c),$("#accordion2").prepend(s.fadeIn())}})}}function createAuthorItem(e,o){for(piece in e)to_search="http://harvardlampoon.com"+e[piece],chrome.storage.sync.get(to_search,function a(e){for(piece in e){var a=e[piece],t=a.Title,n=a.Url,i=localStorage.getItem(n),c=$(".template3"),l=c.clone();l.removeClass("template3"),l.removeClass("invisible"),l.find(".collapse").removeClass("in"),l.find(".accordion-toggle").attr("href","#"+ ++hash).html("<i>"+o+":</i> "+t),l.find(".panel-collapse").attr("id",hash).addClass("collapse").removeClass("in"),l.find(".panel-body").html(i),$("#accordion3").prepend(l.fadeIn())}})}var minusIcon='<img src = "img/circle-with-minus.svg" class = "minus icon inactive"/>',downloadIcon='<img src = "entypo/download.svg" class = "download icon inactive"/>',facebookIcon,twitterIcon,downIcon='<img class = "down icon inactive" src= "entypo/entypo+/entypo+/chevron-with-circle-down.svg"/>',upIcon='<img class = "up icon inactive" src= "entypo/entypo+/entypo+/chevron-with-circle-up.svg"/>',menuBar='<div class = "menu">'+upIcon+downIcon+downloadIcon+minusIcon+"</div>";chrome.storage.onChanged.addListener(function(e,o){console.log("storage was changed");for(var a in e)var t=e[a]});var hash=1;$(document).ready(function(){chrome.storage.sync.get(function(e){if(chrome.runtime.error)alert("an error occurred");else for(item in e){var o=e[item];switch(o.Type){case"author":createAuthorItem(o.List,o.Author);break;case"issue":console.log(o,"it's an issue"),createComixItem(o.Img,o.Title),createIssueItem(o.Img,o.Description,o.Title,o.List);break;case"comix":console.log(o,"it's an comix"),createComixItem(o.Img,o.Title);break;case"piece":o.Img&&createComixItem(o.Img,o.Title),createPieceItem(o.Url,o.Title,o.Author)}}}),$("#jesture-page-link").each(function(){$(this).click(function(e){e.preventDefault();var o=$(this).attr("href"),a=!1;chrome.tabs.getAllInWindow(null,function(e){console.log(o);for(i in e)e[i].url.split("/")[3]==o&&(a=!0,chrome.tabs.update(e[i].id,{selected:!0}));a||chrome.tabs.create({url:o})})})})});