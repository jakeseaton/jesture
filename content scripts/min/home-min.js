chrome.storage.onChanged.addListener(function(e,t){console.log("storage was changed")}),chrome.runtime.onMessage.addListener(function(e,t,i){console.log("message from the background script")});var pieces_object={},titles_in_favorites=[];chrome.storage.sync.get("pieces",function e(t){if(!chrome.runtime.error){for(pieces_object=t.pieces,pieces_index=pieces_object.favorites.length,i=0;i<pieces_index;i++)titles_in_favorites.push(pieces_object.favorites[i].Title);$(".piece-text-container").each(function(){var e=$(".piece-title").html();-1!=$.inArray(e,titles_in_favorites)?(console.log(e,"is in array",titles_in_favorites),0==$(this).has("#jesture-container").length&&$(this).prepend(jesture_active)):(console.log(e,"is not in array",titles_in_favorites),0==$(this).has("#jesture-container").length&&$(this).prepend(jesture_piece))})}});var star_url=chrome.extension.getURL("star.png"),arrow_url=chrome.extension.getURL("arrow.png"),jesture_url=chrome.extension.getURL("jesture_page.html"),right_arrow_url=chrome.extension.getURL("right_arrow.png"),hat_url=chrome.extension.getURL("jesture_hat_5.png"),star_piece="<img id = 'star-piece' class = 'star inactive' src = "+hat_url+" alt = 'star'/>",active_star="<img id = 'star-piece' class = 'star active' src = "+hat_url+" alt = 'star'/>",arrow_html="<a width = '36px' height = '36px' href = "+jesture_url+"><img class = 'arrow' src = "+right_arrow_url+" alt = 'arrow'/></a>",jesture_piece="<div id = 'jesture-container'><div id = 'jesture'>"+star_piece+arrow_html+"</div></div>",jesture_active="<div id = 'jesture-container'><div id = 'jesture'>"+active_star+arrow_html+"</div></div>";$(".star").click(function(){var e={},t=$(".piece-header"),i=$(".piece-title").html(),r=t.find(".piece-author").find("a").html(),s=t.find("a").attr("href"),a=$(".piece-artwork").find("img").attr("src");if(e.Title=i,e.Author=r,e.Url=s,e.Img=a,$(this).hasClass("inactive"))pieces_object.favorites.push(e),chrome.storage.sync.set({pieces:pieces_object},function c(){chrome.runtime.error||chrome.storage.sync.get("pieces",function e(t){console.log(t)})}),$(this).removeClass("inactive"),$(this).fadeTo("fast",1),$(this).addClass("active");else{var o=pieces_object.favorites.indexOf(e);pieces_object.favorites.splice(o,1),chrome.storage.sync.set({pieces:pieces_object},function n(){chrome.storage.sync.get("pieces",function e(t){console.log(t)})}),$(this).removeClass("active"),$(this).addClass("inactive"),$(this).fadeTo("fast",.5)}}),$(".inactive").hover(function(){$(this).fadeTo("fast",1)},function(){$(this).fadeTo("fast",.5)}),$(".arrow").hover(function(){$(this).fadeTo("fast",1)},function(){$(this).fadeTo("fast",.5)});